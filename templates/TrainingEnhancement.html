<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training Enhancement</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="bootstrap-table-en-US.js"></script>
    <script>
        $(document).ready(function () {
            $('#infoId').hide();
            var a=1;
            $('#additionalLinks').hide();
            $('#currentID').hide();
            $('#InjuryID').hide();
            $('#searchInfo').hide();
            $('#timeselect').hide();

             // Event triggered when the page first loads
            $('#additionalLinks').hide();
                $('#infoId').hide();
                $('#currentID').show();
                $('#InjuryID').hide();
                $('#searchInfo').hide();

            // Handles click event on 'Current Session' link: hides various UI components and reveals only the current session information.
            $('#current-session-link').click(function () {
                $('#additionalLinks').hide();
                $('#infoId').hide();
                $('#currentID').show();
                $('#InjuryID').hide();
                $('#searchInfo').hide();
                $('#timeselect').hide();

            });

            // Click event for 'Previous Sessions' link: Shows additional navigation links, hides current session details, and displays the time selection form and injury information.
            $('#previous-sessions-link').click(function () {
                $('#additionalLinks').show();
                $('#InjuryID').hide();
                $('#currentID').hide();
                $('#timeselect').show();

                // 
                $('#infoId').hide();
                $('#InjuryID').show();
                $('#searchInfo').hide();
            });

            // Click event for 'Injury Links': Sets a variable and adjusts visibility of sections related to injuries, hiding irrelevant information.
            $('#injuryLinks').click(function () {
                a=1;
                $('#infoId').hide();
                $('#InjuryID').show();
                $('#searchInfo').hide();
            });

            // On 'Training Links' click: Executes AJAX to fetch training advice based on user input, updating the UI with results or a no-data message.
            $('#trainingLinks').click(function () {
                a=2;
                $('#infoId').show();
                $('#currentID').hide();
                $('#InjuryID').hide();
                
					$('#infoId').hide();
					$('#currentID').hide();
					$('#InjuryID').hide();
					$('#searchInfo').show();
					var date = $('#searchDate').val();
					
                    var username = '{{ username }}';
					$.ajax({
						url: '/login/search_recommend',
						type: 'GET',
						data: {
							date: date,
							username: username,
							search_type:a,
							// Add more parameters as needed for the request
						},
						success: function (data) {
							var htmlContent = '';
							// Process the data returned from the backend
							console.log(data);
							if (data.length==0){
								$('#searchInfo').empty();

							htmlContent += '<div class="mt-3">';
                                if(a==1){
                                    htmlContent += '<div class="other-content">no video to analyse</div>';
                                }
                                else{htmlContent += '<div class="other-content">No data from that date</div>';}
							
						
							console.log(htmlContent)
							}
							else
							{
								$('#searchInfo').empty();
							htmlContent += '<div class="mt-3">';
							
							// Iterate over the returned data and append it to the page
							data.forEach(function (item) {
								htmlContent += '<div>'; //Start new div
								htmlContent += '<p>Date: ' + item.date + '</p>';
								htmlContent += '<p>Session: ' + item.session + '</p>';
								htmlContent += '<p>Advice: ' + item.training_advice + '</p>';
								htmlContent += '</div>'; // Close div
								htmlContent += '<hr>'; // Add a horizontal line for separation

								
							});
                            htmlContent += '</div>'; // Close the outer div
							htmlContent += '<div class="mt-3">';
							// htmlContent += '<h5>Exercises for Injury prevention:</h5>';
							// htmlContent += '<p>Details of exercises aimed at preventing injuries...</p>';
							htmlContent += '</div>';
							htmlContent += '<div class="mt-3">';
							// htmlContent += '<h5>Other Improvements:</h5>';
							// htmlContent += '<p>Additional recommendations for improvement...</p>';
							htmlContent += '</div>';
							console.log(htmlContent)
							}
							
							$('#searchInfo').append(htmlContent);
						}
					});
                    

            });
            $('#searchButton').click(function () {
                $('#infoId').hide();
                $('#currentID').hide();
                $('#InjuryID').hide();
                $('#searchInfo').show();
                // Fetch the selected date from the search input
                var date = $('#searchDate').val();
                // var serach_type=
                console.log(a)

                var username = '{{ username }}';
                $.ajax({
                    url: '/login/search_recommend',
                    type: 'GET',
                    data: {
                        date: date,
                        username: username,
                        search_type:a,
                        // Additional parameters can be added here
                    },
                    success: function (data) {
                        var htmlContent = '';
                        // Process and display data returned from the backend
                        console.log(data);
                        if (data.length==0){
                            // If no data returned, clear the search information container
                            $('#searchInfo').empty();
if(a==1){
htmlContent += '<div class="other-content">no video to analyse</div>';
}
 else{htmlContent += '<div class="other-content">No data from that date</div>';}
                        // htmlContent += '<div class="mt-3">';
                        // htmlContent += '<h5>No data from that date</h5>';
                    
                        console.log(htmlContent)
                        }
                        else
                        {
                            $('#searchInfo').empty();
                        htmlContent += '<div class="mt-3">';
                        
                        // Iterate over the returned data and add it to the page
                        data.forEach(function (item) {
                            htmlContent += '<div>'; // Open a new div for each item
                            htmlContent += '<p>Date: ' + item.date + '</p>';
                            htmlContent += '<p>Session: ' + item.session + '</p>';
                            htmlContent += '<p>Advice: ' + item.training_advice + '</p>';
                            htmlContent += '</div>'; // Close the div for the item
                            htmlContent += '<hr>'; // Add a separator line

                            htmlContent += '</div>'; // Close the outer div
                        htmlContent += '<div class="mt-3">';
                        
                        });
                    //    htmlContent += '<h5>Exercises for Injury prevention:</h5>';
                        // htmlContent += '<p>Details of exercises aimed at preventing injuries...</p>';
                        htmlContent += '</div>';
                        htmlContent += '<div class="mt-3">';
                        // htmlContent += '<h5>Other Improvements:</h5>';
                        // htmlContent += '<p>Additional recommendations for improvement...</p>';
                        htmlContent += '</div>';
                        console.log(htmlContent)
                        }
                        
                        $('#searchInfo').append(htmlContent);
                    }
                });
            });
        });
    </script>
    <style>
        .welcome-text {
            margin-right: 20px; 
        }
        .hidden {
        display: none;
    }
        .other-content {
            text-align: center;  
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">SportsInsight</a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Player Details</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="http://localhost:8000/data?page=1">Data</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Recommendations</a> <!-- This is the current page -->
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Medical</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Training Schedule</a>
                    </li>
                </ul>
            </div>
            <span class="welcome-text">Hi Player</span>
            <button class="btn btn-outline-success" type="submit">Logout</button>
        </div>
    </nav>

    <div class="container mt-5">
        <ul class="nav nav-tabs">
            <li class="nav-item"><a id="current-session-link" class="nav-link" href="#">Current Session</a></li>
            <li class="nav-item"><a  id="previous-sessions-link" class="nav-link" href="#">Previous Sessions</a></li>
        </ul>
        <ul id="additionalLinks" class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link" id="injuryLinks" href="#">Injury Prevention & Technique Enhancement</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="trainingLinks" href="#">Training Recommendations</a>
            </li>
        </ul>

        <div class="mt-3" id="timeselect" data-locale="en-US">
            <div class="input-group mb-3">
                <span class="input-group-text" id="basic-addon1">Select date</span>
                <input type="date" class="form-control" aria-label="Date" aria-describedby="basic-addon1", id="searchDate">
                <button class="btn btn-primary" type="button" id="searchButton">Search</button> <!-- Search button added here -->
            </div>
        </div>
        
        <div id="infoId">
            <div class="mt-3">
            {% for performance in latest_performances %}
                {% if performance.training_advice %}
                    <p>Date: {{ performance.date }}</p>
                    <p>Session: {{ performance.session }}</p>
                    <p>Advice: {{ performance.training_advice }}</p>
                {% endif %}
                <hr>
            {% empty %}
                <p>No training advice available.</p>
            {% endfor %}
        </div>

        <!-- <div class="mt-3">
            <h5>Exercises for Injury prevention:</h5>
            <p>Details of exercises aimed at preventing injuries...</p>
        </div>

        <div class="mt-3">
            <h5>Other Improvements:</h5>
            <p>Additional recommendations for improvement...</p>
        </div> -->
        </div>
        <div id="searchInfo"></div>
        <div id="currentID" class="other-content">no current session . Go to Previous Sessions</div>
        <div id="InjuryID" class="other-content">no video to analyse</div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" defer></script>
</body>
</html>
